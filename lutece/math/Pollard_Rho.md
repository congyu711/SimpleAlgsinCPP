# Pollard_Rho
（感觉网上都讲的不是很清楚，wiki也没有中文页面）
John Pollard在1975年发明，用于整数分解

维基百科说复杂度和被分解整数的最小质因子的平方根同阶

实际上是在使用birthday trick

birthday trick就是1-n的整数随机选k个，有相同的数字的概率是
$$P=1 - \frac{A_n^k}{n^k}$$
在k较小时，这个概率随k增加而接近1的速度很快，很快就非常接近1

这里随机生成[1,n]的a，b（a<b）
如果$$a=b(mod \quad p)$$ (p是n的一个质因数)
有$$p|(b-a)$$   $$(n,b-a) \geq p$$
则有 $(b-a,n)$是n的一个大于1的因子

现在考虑一个伪随机数的序列，
$$x,f(x),f(f(x))...... $$
其中$f(x)=(x*x+c)mod \: n$,这样一来通过birthday trick可以得知大概经过$O(\sqrt{n})$次就会产生一个循环。
对于相同的的x，他后面的数一定是相同的

然后考虑把这个序列带入ab，如果$(b-a,n)!=1$，由上面的推导可以得知我们找到了n的一个非1的因子。如果等于1，继续找。
现在还剩一个问题，需要考虑何时停止迭代ab。使用Floyd判环方法，b每次走两步，a每次走一步，判断a，b是否相遇，如果相遇说明至少已经走过一个环。

对于小整数，随机生成的c非常容易让f函数产生一个非常短的循环，只能取到几个```abs(a-b)```，一般来说很难找到因数，此时还需要重新生成随机数c，然后继续看是否能找到因数。这就需要结合miller rabin算法判断被分解的数是否是合数，是合数就一直随机到获得因数为止。

简单分析一下复杂度：
